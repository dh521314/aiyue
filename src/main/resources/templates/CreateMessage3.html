<!DOCTYPE html>
<!-- saved from url=(0058)https://write.qq.com/portal/dashboard/create-novel?artidx= -->
<html lang="zh-CN" style=""><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="robots" content="all">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="description" content="作家专区是阅文集团致力于原创作家孵化、培育、创作、挖掘的网络文学平台，作家可以通过作家学院在线课程的学习，使用作家专区及作家助手移动端APP发布与管理小说、查看数据、与读者互动。">
    <meta name="keywords" content="写小说，作家学院，作家专区，原创文学，网络文学，网络小说，在线写作，作家助手，起点中文网，创世中文网，云起书院，起点女生网，起点文学网，阅文集团">
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <title>
      
    创建长篇小说
-阅文作家专区
    </title>

    <link rel="shortcut icon" type="image/x-icon" href="https://write.qq.com/portal/public/images/favicon.ico">
    <link rel="Bookmark" type="image/x-icon" href="https://write.qq.com/portal/public/images/favicon.ico">
    <!--   <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0;" name="viewport" />-->
    <link rel="stylesheet" href="CreateMessage3_files/reset.css">
    <link rel="stylesheet" href="CreateMessage3_files/index.css">
    <link rel="stylesheet" href="CreateMessage3_files/font.css">
    <link rel="stylesheet" href="CreateMessage3_files/module.css">
    <link rel="stylesheet" href="CreateMessage3_files/layout.css">
    <link rel="stylesheet" href="CreateMessage3_files/header.css">
    <link rel="stylesheet" href="CreateMessage3_files/footer.css">
    <link rel="stylesheet" href="CreateMessage3_files/dialog.css">

    
    
<link rel="stylesheet" href="CreateMessage3_files/common.css">
<link rel="stylesheet" href="CreateMessage3_files/ui.css">
<link rel="stylesheet" href="CreateMessage3_files/dashboard-common.css">
<link rel="stylesheet" href="CreateMessage3_files/dashboard-form.css">
<link rel="stylesheet" href="CreateMessage3_files/dashboard-book-create.css">


    
    <script src="CreateMessage3_files/stats.js" name="MTAH5" sid="500659219" cid="500664628"></script><script async="" src="CreateMessage3_files/yep.js"></script><script type="text/javascript" src="CreateMessage3_files/aq_common.js"></script>

    
    <script type="text/javascript">
      (function(i,s,o,g,r,a,m){i['QDAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://noah2-1252317822.file.myqcloud.com/npm/@noah-common/yep@0.0.46/dist/yep.js','yep');
      yep('set', {
        appid: 10040,
        rate: .1
      }),
      yep('custom', {
        w_darkmode: ( !!window.matchMedia ) && window.matchMedia("(prefers-color-scheme: dark)").matches ? 1 : 0
      });
    </script>
  </head>
  <body style="zoom: 1;">
    
    


<div class="g-header">
    <div class="header shadow" id="j-siteHeader">
  <!--<div class="box-center cf">
    &lt;!&ndash; 未登录 &ndash;&gt;
    <div class="no-login">
      
    </div>
    &lt;!&ndash; 图标列表，包含用户信息 &ndash;&gt;
    <div class="icon-list j-slideDownList">
      <ul>
        
        <li>
          <a class="icon-font" href="https://write.qq.com/portal/dashboard"><cite class="icon-hover-tip down">工作台</cite></a>
        </li>
        
        <li>
          <a class="icon-font" href="javascript:"></a>
          <div class="slide-down-wrap list">
            <cite><span><i></i></span></cite>
            <dl>
              <dd onclick="tucao()"><a href="javascript:;">意见反馈</a></dd>
              <dd><a href="https://write.qq.com/contentv2/about/help_center.html" target="_blank">帮助中心</a></dd>
              <dd><a href="https://write.qq.com/portal/version" target="_blank">更新说明</a></dd>
            </dl>
          </div>
        </li>
        
        <li class="j-notify">
          
          <a class="icon-font" href="https://write.qq.com/portal/dashboard/authorConsult">
            
            <cite class="icon-hover-tip down">通知</cite>
          </a>
        </li>
        <li class="user-info">
          <a class="avatar-box" href="javascript:" id="j-avatarBox">
            <img class="avatar" src="CreateMessage3_files/photo_default.png" onerror="javascript:this.src=&#39;https://ccstatic-1252317822.file.myqcloud.com/portraitimg/2019-09-19/5d82ecf354f0d.png&#39;;">
          </a>
          <div class="slide-down-wrap user-detail">
            <cite><span><i></i></span></cite>
            <div class="detail-wrap">
              <div class="level-info">
                <h3>
                  <i>原创作家</i>
                  
                  <em>普通</em>
                </h3>
                
              </div>
              <div class="menu-list">
                <dl>
                  <dd><a href="https://write.qq.com/portal/dashboard/books" target="_blank">作品管理</a></dd>
                  <dd><a href="https://write.qq.com/portal/booknovels/chaptertmp/CBID/17958922108504204" target="_blank">立即写作</a></dd>
                </dl>
                <dl>
                  <dd><a href="https://write.qq.com/portal/collect">我收藏的文章</a></dd>
                  <dd><a href="https://write.qq.com/portal/mycolumn">我关注的专栏</a></dd>
                </dl>
                <dl>
                  <dd><a href="https://write.qq.com/portal/dashboard/authorInfo" target="_blank"><span>完整度 50%</span>个人资料</a></dd>
                  <dd><a href="https://write.qq.com/portal/mod-vip-password" target="_blank">修改 VIP 密码</a></dd>
                  <dd><a href="javascript:" id="logout">退出登录</a></dd>
                </dl>
              </div>

            </div>
          </div>
        </li>
        
      </ul>
    </div>-->
    <!-- logo -->
    <!--<div class="logo">
      <h1 title="阅文作家专区"><a href="https://write.qq.com/"></a></h1>
      
      <div class="nav-item j-slideDownList">
        <ul>
          <li>
            
            <div class="slide-down-wrap list">
              <cite><span><i></i></span></cite>
              <dl>
                <dd><a href="https://write.qq.com/">首页</a></dd>
                <dd><a href="https://write.qq.com/portal/article">文章</a></dd>
                <dd><a href="https://write.qq.com/portal/spcolumn">专栏</a></dd>
                <dd><a href="https://write.qq.com/portal/news">资讯</a></dd>
              </dl>
            </div>
          </li>
        </ul>
      </div>
    </div>-->
  </div>
</div>
<script src="CreateMessage3_files/ywlogin_v1.js"></script>
<script>
  yw.setParams({
    "appId": "34",
    "areaId": "1006",
    "popup_close":1,
    "ticket":1,
    // 可选回调页面
    "returnUrl": "/public/logout.html" ,
    "autoshow": 1 ,
    "unionshow":11111,
    "auto":1,
    "autotime":7
  });
  var logoutEl = document.getElementById("logout");
  if (logoutEl) {
    if (logoutEl.addEventListener) {
      logoutEl.addEventListener("click", function() {
        yw.logout(function(){
          location.href = '/public/logout.html';
        });
      });
    } else {
      logoutEl.attachEvent("onclick", function() {
        yw.logout(function(){
          location.href = '/public/logout.html';
        });
      });
    }
  }
</script>
    <script src="CreateMessage3_files/jquery.js"></script>
    <script src="CreateMessage3_files/all.js"></script>

</div>
<div class="g-row mt24 work-create">
    <div class="g-col g-col-2 g-side">
        <div class="g-side-con">
 <!--
<div class="g-nav g-section-bg">
    <ul>
        <li data-event-id="1">
            &lt;!&ndash; 高亮添加这个class &ndash;&gt;
            <a href="javascript:void(0)"><em class="icon-font"></em><em class="icon-font active"></em>工作台</a>
        </li>
        <li data-event-id="2">
            <a href="javascript:void(0)"><em class="icon-font"></em><em class="icon-font active"></em>作品管理</a>
        </li>
        &lt;!&ndash;<li data-event-id="3">
            <a href="https://write.qq.com/booknovelsvip/takeindex.html"><em class="icon-font"></em><em class="icon-font active"></em>数据中心</a>
        </li>
        <li data-event-id="4">
            <a href="https://write.qq.com/income/index.html"><em class="icon-font"></em><em class="icon-font active"></em>稿酬收入</a>
        </li>
        <li data-event-id="5">
            <a href="https://write.qq.com/labor.html"><em class="icon-font"></em><em class="icon-font active"></em>劳务收入</a>
        </li>
        <li data-event-id="6" class="sidebar-interactive">
            <a href="https://write.qq.com/portal/dashboard/interactive-manage"><em class="icon-font"></em><em class="icon-font active"></em>互动管理</a>
            <div class="interactive-guide">
                <p class="interactive-guide-txt"><em class="interactive-guide-star icon-font"></em>新版<span class="c-primary">评论管理</span>全新上线，快来看看</p>
                <div class="interactive-guide-footer"><a href="https://write.qq.com/portal/dashboard/interactive-manage" class="ui-button ui-button-primary">去看看</a></div>
            </div>
        </li>
        <li data-event-id="7">
            <a href="https://write.qq.com/portal/dashboard/exchange">
                <em class="icon-font"></em><em class="icon-font active"></em>积分兑换
                
            </a>
        </li>
        <li data-event-id="8">
            <a href="https://write.qq.com/portal/dashboard/authorConsult"><em class="icon-font"></em><em class="icon-font active"></em>作家咨询</a>
        </li>
        &ndash;&gt;
    </ul>
</div>


<script>
    $(".g-nav li").on("click", function() {
        var $this = $(this);
        var cauthorid = "17752236906517001";
        var eventID = $this.data("event-id");
        dataReport({
            pageid: "ZQ_common",
            eventid: "ZQ_E0" + eventID,
            cauthorid: cauthorid
        });
    });

    function showReviewManageGuide() {
        $.ajax({
            dataType: 'json',
            contentType: "application/json",
            url: '/portal/domesticsite?service=guideservice&action=isGuide&type=69&t=' + Date.now(),
            success: function(res) {
                if (res.returnCode == 200 && !res.result) {
                    $(".interactive-guide").show();
                }
            }
        });
    }
    $.ajax({
        dataType: 'json',
        contentType: "application/json",
        url: '/ccauthorweb/reviewmanager/getGrayLevelControl?t=' + Date.now(),
        success: function(res) {
            if (res.returnCode == 2000 && res.result == 1) {
                showReviewManageGuide();
            }
        }
    });
</script>

 
        </div>
    </div>-->
    <div class="g-col g-col-10">
        <div class="g-section-bg g-body-h1">
            <div class="g-body-h2">
            
                
                <div class="g-title-h2 mb24">
                    <h2 class="g-h2">创建作品</h2>
                </div>
                <div class="wc-progress _step3">
                    <div class="wcp-item _one">
                        <div class="wcp-status">
                            <i class="wcp-icon _num">1</i>
                            <i class="wcp-icon _numbg">1</i>
                            <i class="wcp-icon _finished"><em class="icon-font input-vertified"></em></i>
                        </div>
                        <p class="wcp-txt">选择类型</p>
                    </div>
                    <div class="wcp-item _two">
                        <div class="wcp-status">
                            <i class="wcp-icon _num">2</i>
                            <i class="wcp-icon _numbg">2</i>
                            <i class="wcp-icon _finished"><em class="icon-font input-vertified"></em></i>
                        </div>
                        <p class="wcp-txt">完善作品信息</p>
                    </div>
                    <div class="wcp-item _three">
                        <div class="wcp-status">
                            <i class="wcp-icon _num">3</i>
                            <i class="wcp-icon _numbg">3</i>
                            <i class="wcp-icon _finished"><em class="icon-font input-vertified"></em></i>
                        </div>
                        <p class="wcp-txt">创建成功</p>
                    </div>
                </div>
                <div class="wc-step wc-form dn" id="step1Form">
                    <div class="write-form-li">
                        <label class="write-form-label">目标读者</label>
                        <div class="write-form-cell">
                            <div class="write-input">
                                
                                <label class="lrc-item">
                                    <input type="radio" id="sex1" name="sex" value="1">
                                    <label for="sex1" class="ui-radio"></label><label class="radio-txt" for="sex1">男生</label>
                                    <div class="rc-con">
                                        <p class="input-caution">以男性视角或男性受众为主的作品</p>
                                        <p class="input-caution">玄幻/奇幻/历史/都市/灵异/仙侠/游戏/二次元/武侠/军事等所有男生题材</p>
                                    </div>
                                </label>
                                
                                <label class="lrc-item">
                                    <input type="radio" id="sex2" name="sex" value="2">
                                    <label for="sex2" class="ui-radio"></label><label class="radio-txt" for="sex2">女生</label>
                                    <div class="rc-con">
                                        <p class="input-caution">以女性视角或女性受众为主的作品</p>
                                        <p class="input-caution">古言/现言/玄幻/青春/悬疑/科幻/仙侠/游戏/N次元等所有女生题材</p>
                                    </div>
                                </label>
                                
                            </div>
                        </div>
                    </div>
                    <div class="write-form-li  write-form-button">
                        <label class="write-form-label"></label>
                        <button class="ui-button ui-large ui-button-primary jNext">下一步</button>
                        
                    </div>
                </div>
                <div class="wc-step wc-form dn" id="step2Form"><form novalidate="novalidate">
    <div class="write-form-li">
        <label class="write-form-label">发布平台</label>
        <div class="write-form-cell">
            <div class="write-input line-rcs lrc-item">
            
                <input type="radio" id="site2" name="site" value="2">
                <label for="site2" class="ui-radio"></label>
                <label class="radio-txt mr24" for="site2">QQ阅读</label>
            
                <input type="radio" id="site3" name="site" value="3">
                <label for="site3" class="ui-radio"></label>
                <label class="radio-txt mr24" for="site3">起点读书</label>
            
                <input type="radio" id="site23" name="site" value="23">
                <label for="site23" class="ui-radio"></label>
                <label class="radio-txt mr24" for="site23">红袖读书</label>
            
                <input type="radio" id="site22" name="site" value="22">
                <label for="site22" class="ui-radio"></label>
                <label class="radio-txt mr24" for="site22">潇湘书院</label>
            
            <p class="input-error"></p>
            </div>
        </div>
    </div>

    <div class="write-form-li">
        <label class="write-form-label" for="title">作品名称</label>
        <div class="write-form-cell">
            <div class="write-input">
                <div class="ui-input j-check _check">
                
                    <input name="title" placeholder="请填写" class="" aria-invalid="false">
                    <em class="icon-font input-vertified icon_check_circle"></em>
                </div>
                <p class="input-caution">15字以内，请勿添加书名号等特殊符号</p>
                <p class="input-error">请填写作品名称</p>
            </div>
        </div>
    </div>

    <div class="write-form-li" id="catFormLi">
        <label class="write-form-label">作品类型</label>
        <div class="write-form-cell">
            <div class="write-input">
                <div class="_twocolumn">
                    <div class="ui-input">
                        <select id="catSelect" name="category" style="display: none;"><option></option>
<option value="30001">玄幻言情</option>
<option value="30008" selected="">仙侠奇缘</option>
<option value="30013">古代言情</option>
<option value="30020">现代言情</option>
<option value="30031">浪漫青春</option>
<option value="30036">悬疑侦探</option>
<option value="30042">科幻空间</option>
<option value="30050">游戏竞技</option>
<option value="30055">轻小说</option>
<option value="30078">纯爱小说</option>
<option value="30120">现实生活</option></select><div role="combobox" class="ui-select" style="width: 208px;"><a href="javascript:" data-target="catSelect" role="button" aria-expanded="false" aria-owns="catSelect" class="ui-select-button"><span class="ui-select-text">仙侠奇缘</span><em class="icon-font-arrowdown"></em></a><div id="catSelect" role="listbox" aria-expanded="true" class="ui-select-datalist"><a href="javascript:" class="ui-select-datalist-li " data-index="0" data-target="catSelect" role="option" aria-selected="false"></a><a href="javascript:" class="ui-select-datalist-li " data-index="1" data-target="catSelect" role="option" aria-selected="false">玄幻言情</a><a href="javascript:" class="ui-select-datalist-li  selected" data-index="2" data-target="catSelect" role="option" aria-selected="true">仙侠奇缘</a><a href="javascript:" class="ui-select-datalist-li " data-index="3" data-target="catSelect" role="option" aria-selected="false">古代言情</a><a href="javascript:" class="ui-select-datalist-li " data-index="4" data-target="catSelect" role="option" aria-selected="false">现代言情</a><a href="javascript:" class="ui-select-datalist-li " data-index="5" data-target="catSelect" role="option" aria-selected="false">浪漫青春</a><a href="javascript:" class="ui-select-datalist-li " data-index="6" data-target="catSelect" role="option" aria-selected="false">悬疑侦探</a><a href="javascript:" class="ui-select-datalist-li " data-index="7" data-target="catSelect" role="option" aria-selected="false">科幻空间</a><a href="javascript:" class="ui-select-datalist-li " data-index="8" data-target="catSelect" role="option" aria-selected="false">游戏竞技</a><a href="javascript:" class="ui-select-datalist-li " data-index="9" data-target="catSelect" role="option" aria-selected="false">轻小说</a><a href="javascript:" class="ui-select-datalist-li " data-index="10" data-target="catSelect" role="option" aria-selected="false">纯爱小说</a><a href="javascript:" class="ui-select-datalist-li " data-index="11" data-target="catSelect" role="option" aria-selected="false">现实生活</a></div></div>
                    </div>
                    <div class="ui-input">
                        <select id="subcatSelect" name="subcategory" style="display: none;"><option value="30009">武侠情缘</option><option value="30010">古典仙侠</option><option value="30011">现代修真</option><option value="30012">远古洪荒</option><option value="30093">仙侣奇缘</option></select><div role="combobox" class="ui-select" style="width: 208px;"><a href="javascript:" data-target="subcatSelect" role="button" aria-expanded="false" aria-owns="subcatSelect" class="ui-select-button"><span class="ui-select-text">武侠情缘</span><em class="icon-font-arrowdown"></em></a><div id="subcatSelect" role="listbox" aria-expanded="true" class="ui-select-datalist"><a href="javascript:" class="ui-select-datalist-li  selected" data-index="0" data-target="subcatSelect" role="option" aria-selected="true">武侠情缘</a><a href="javascript:" class="ui-select-datalist-li " data-index="1" data-target="subcatSelect" role="option" aria-selected="false">古典仙侠</a><a href="javascript:" class="ui-select-datalist-li " data-index="2" data-target="subcatSelect" role="option" aria-selected="false">现代修真</a><a href="javascript:" class="ui-select-datalist-li " data-index="3" data-target="subcatSelect" role="option" aria-selected="false">远古洪荒</a><a href="javascript:" class="ui-select-datalist-li " data-index="4" data-target="subcatSelect" role="option" aria-selected="false">仙侣奇缘</a></div></div>
                    </div>
                </div>
                <p class="input-caution"></p>
                <p class="input-error">请选择作品类型</p>
            </div>
        </div>
    </div>

    <div class="g-hr mt24 mb24"></div>
    <div class="write-form-li" id="actarticleFormLi">
        <label class="write-form-label">征文活动</label>
        <div class="write-form-cell">
            <div class="write-input bc-act">
    <div class="write-input lrc-item">
        <input type="radio" id="act0" name="actarticle" value="0" checked="checked">
        <label for="act0" class="ui-radio"></label>
        <label class="radio-txt mr24" for="act0">不参加活动</label>
    </div>

    
    <div class="write-input lrc-item">
        <input type="radio" id="act596" name="actarticle" value="596">
        <label for="act596" class="ui-radio"></label>
        <label class="radio-txt mr24" for="act596">
            2020和平精英原创文学大赛
            <a class="bc-act-link" href="https://write.qq.com/portal/dashboard/actarticleDetail?id=596" target="_blank">活动详情</a>
        </label>
    </div>
    
    <div class="write-input lrc-item">
        <input type="radio" id="act597" name="actarticle" value="597">
        <label for="act597" class="ui-radio"></label>
        <label class="radio-txt mr24" for="act597">
            第五届现实题材网络文学征文大赛
            <a class="bc-act-link" href="https://write.qq.com/portal/dashboard/actarticleDetail?id=597" target="_blank">活动详情</a>
        </label>
    </div>
    
    <div class="write-input lrc-item">
        <input type="radio" id="act603" name="actarticle" value="603">
        <label for="act603" class="ui-radio"></label>
        <label class="radio-txt mr24" for="act603">
            石榴杯征文大赛
            <a class="bc-act-link" href="https://write.qq.com/portal/dashboard/actarticleDetail?id=603" target="_blank">活动详情</a>
        </label>
    </div>
    
</div>
        </div>
    </div>

    <div class="write-form-li dn" id="actextFormLi">
        <label class="write-form-label">选择赛区</label>
        <div class="write-form-cell">
            <div class="write-input">
                <p class="input-error">请选择赛区</p>
            </div>
        </div>
    </div>
    <!-- <div class="g-hr mt24 mb24"></div> -->

    <div class="write-form-li dn" id="precollectionFormLi">
        <label class="write-form-label">预收藏</label>
        <div class="write-form-cell">
            <div class="write-input lrc-item ">
                
                
                <input type="radio" id="preYes" name="precollection" value="1" disabled="">
                <label for="preYes" class="ui-radio"></label><label class="radio-txt " for="preYes">是</label>
                <i class="icon-idb jsThemeTips mr24" title="按照单章订阅价格付费阅读作品章节内容" tabindex="0" role="tooltip"><em class="icon-font icon_info input-vertified"></em></i> 
                <input type="radio" id="preNo" name="precollection" value="0" checked="">
                <label for="preNo" class="ui-radio"></label><label class="radio-txt " for="preNo">否</label>
                
            </div>
            <p class="pre-collect-note _info">创建预收藏作品需要消耗预收藏作品券，你可以在积分兑换页面中消耗 666 积分进行兑换<i class="icon-idb jsThemeTips mr24" tabindex="0" role="tooltip" aria-label="预收藏作品创建成功后会生成默认章节，正文章节（含默认章节）内容满1000字后会变为正常作品，预收藏标识消失。"><em class="icon-font icon_info input-vertified"></em></i></p>
        </div>
    </div>

    <div class="write-form-li" id="saletypeFormLi">
        <label class="write-form-label">销售意向</label>
        <div class="write-form-cell">
            <div class="write-input lrc-item _info">
                <input type="radio" id="saleSingle" name="saletype" value="1" class="">
                <label for="saleSingle" class="ui-radio"></label><label class="radio-txt " for="saleSingle">单订</label>
                <i class="icon-idb jsThemeTips mr24" tabindex="0" role="tooltip" aria-label="按照单章订阅价格付费阅读作品章节内容"><em class="icon-font icon_info input-vertified"></em></i>
                <input type="radio" id="saleMonth" name="saletype" value="2" class="">
                <label for="saleMonth" class="ui-radio"></label><label class="radio-txt " for="saleMonth">包月</label>
                <i class="icon-idb jsThemeTips mr24" title="付X元/月看所有包月作品" tabindex="0" role="tooltip"><em class="icon-font icon_info input-vertified"></em></i>
                <p class="input-error">请选择销售意向</p>
            </div>
        </div>
    </div>

    <div class="write-form-li" id="introFormLi">
        <label class="write-form-label">作品介绍</label>
        <div class="write-form-cell">
            <!-- 添加warning，会出现释放焦点检验有误的样式 -->
            <div class="write-input">
            
                <div class="ui-textarea j-check _check">
                
                    <textarea rows="8" placeholder="请填写" name="intro" class="" aria-invalid="false"></textarea>
                    <em class="icon-font input-vertified icon_check_circle"></em>
                </div>
                <p class="input-caution">20~500字</p>
                <p class="input-error">请输入20-500字介绍您的作品</p>
            </div>
        </div>
    </div>

    <div class="write-form-li" id="editorGroupFormLi">
        <label class="write-form-label">编辑组</label>
        <div class="write-form-cell">
            <div class="write-input">
                <p class="bc-check-group jEmptyEditor dn">
                    <a class="bc-cg-operate jEvokeEditorModal" href="javascript:" data-event-id="ZQ_E05" role="button">请选择编辑组</a>
                </p>
                <p class="bc-check-group jSelectedEditor">
                    <span class="bc-cg-txt mr24">第二编辑组</span>
                    <a class="bc-cg-operate jEvokeEditorModal" href="javascript:" data-event-id="ZQ_E08">更换</a>
                </p>
                <input class="dn" name="editorGroup">
                <p class="input-caution">作品选择对应的编辑组以后将无法修改，请谨慎选择</p>
                <p class="input-error">请选择编辑组</p>
            </div>
        </div>
    </div>
    <div class="write-form-li" id="pagemessFormLi">
        <label class="write-form-label">给读者的话</label>
        <div class="write-form-cell">
            <div class="write-input">
                <div class="ui-textarea j-check _check">
                    <textarea rows="4" placeholder="在阅文旗下产品阅读我的正版授权作品，感谢您的支持！" name="pagemess" aria-invalid="false"></textarea>
                    <em class="icon-font input-vertified icon_check_circle"></em>
                </div>
                <p class="input-caution">0～32字，给读者的话将展示在您作品的版权页</p>
                <p class="input-error"></p>
            </div>
        </div>
    </div>

    <div class="write-form-li write-form-button">
        <label class="write-form-label"></label>
        <button class="ui-button ui-large ui-button-primary jSubmit" type="button">创建作品</button>
        <button class="ui-button ui-large jPrev" type="button">返回上一步</button>
    </div>
</form></div>
                <div class="wc-step wc-success wc-form" id="step3Form">
                    <div class="g-success">
                        <img class="g-success-pic" src="CreateMessage3_files/success_book.png" width="160" height="160" alt="作品创建成功">
                        <h5 class="g-success-title">作品创建成功</h5>
                        <div class="">
                            
                            <p class="g-success-txt">新建作品后，请尽快新建章节，章节写满1000字之后将会进入编辑审核后台，编辑将会尽快进行审核。</p>
                            <p class="g-success-txt-error">注意：严禁上传任何情色、低俗、涉政等违法违规内容。一旦查实，视情节严重程度全书屏蔽整改起步并取消福利，直至报警处理。</p>
                        </div>
                        <!-- <div class="wc-success-btns"> -->
                        <a href="http://localhost:8088/aiyue/writerQ/queryMessageByMename" target="_blank" class="g-success-btn ui-button ui-large ui-button-primary" role="button">开始写作</a>
                        <!-- </div> -->
                    </div>
                </div>
            </div>
        </div>
        <div class="footer-new" id="j-siteFooter">
  <!-- <div class="box-center"> -->
    <!-- <div class="footer-ft"> -->
      <!-- <p class="copy-right fr">© 2020 阅文集团 版权所有</p> -->
      <div class="footer-info">
          <a class="footer-link" href="https://write.qq.com/contentv2/about/help_center.html" target="_blank">帮助中心</a>
          <a class="footer-link" href="https://www.yuewen.com/service.html" target="_blank">联系我们</a>
          <a class="footer-link" href="http://join.book.qq.com/introduction.html" target="_blank">关于我们</a>
          <a class="footer-link" href="http://join.book.qq.com/social.html" target="_blank">诚聘英才</a>
          <a class="footer-link" href="https://write.qq.com/contentv2/about/copyright.html" target="_blank">版权信息</a>
          <p class="footer-link">© 2020 阅文集团 版权所有</p>
      </div>
    <!-- </div> -->
  <!-- </div> -->
</div>
    </div>
</div>

<!-- 公用js -->
<script src="CreateMessage3_files/jquery.js"></script>
<script src="CreateMessage3_files/jquery.cookie.js"></script>



<script src="CreateMessage3_files/util.js"></script>
<script src="CreateMessage3_files/dialog.js"></script>
<script src="CreateMessage3_files/ajax.js"></script>
<script src="CreateMessage3_files/header.js"></script>
<script src="CreateMessage3_files/common.js"></script>
<script src="CreateMessage3_files/qrcode.min.js"></script>
<script src="CreateMessage3_files/browser.js"></script>
<script src="CreateMessage3_files/tucao.js"></script>
<script>
  function tucao() {
    var cauthorid = '17752236906517001'
    if (cauthorid == null || cauthorid == '') {
      window.location.href = '/public/login.html?artidx=-100';
    } else {
      var _browser = CS.browser;

      var data = {
        "nickname": '原创作家',
        "avatar": "https://ccstatic-1252317822.file.myqcloud.com/writer/p1/contentv2/photo_default.png",
        "openid": '17752236906517001',
        "os": _browser.detectOS(),
        "clientInfo": _browser.browserType(),
        "clientVersion": _browser.browserType(),
        "customInfo": '原创作家' + '17752236906517001'
      };
      var productId = 1924;
      Tucao.request(productId, data);
    }
  }

</script>
<script>
  function getCookie(name) { 
    var arr,reg=new RegExp("(^| )"+name+"=([^;]*)(;|$)");
 
    if(arr=document.cookie.match(reg))
      return unescape(arr[2]); 
    else 
      return ''; 
  }
  $(document).ready(function() {
    $(document).ajaxSend(function(event, jqxhr, settings) {
      jqxhr.setRequestHeader('X-TOKEN', getCookie("pubtoken"));
    });
  });
</script>
<script src="CreateMessage3_files/data-report.js"></script>


<script src="CreateMessage3_files/jquery.js"></script>
<script src="CreateMessage3_files/all.js"></script>
<script src="CreateMessage3_files/underscore.js"></script>
<script src="CreateMessage3_files/jquery.validate.min.js"></script>
<script type="text/template" id="siteSelectTpl">
    <div class="write-form-li">
        <label class="write-form-label">发布平台</label>
        <div class="write-form-cell">
            <div class="write-input line-rcs lrc-item">
            <% _.each(data, function (item) { %>
                <input type="radio" id="site<%= item.site %>" name="site" value="<%= item.site %>">
                <label for="site<%= item.site %>" class="ui-radio"></label>
                <label class="radio-txt mr24" for="site<%= item.site %>"><%= item.name %></label>
            <% }); %>
            <p class="input-error"></p>
            </div>
        </div>
    </div>
</script>
<script type="text/template" id="nameInputTpl">
    <div class="write-form-li">
        <label class="write-form-label" for="title">作品名称</label>
        <div class="write-form-cell">
            <div class="write-input">
                <div class="ui-input j-check">
                
                    <input name="title" placeholder="请填写">
                    <em class="icon-font input-vertified icon_check_circle">&#xe90b;</em>
                </div>
                <p class="input-caution">15字以内，请勿添加书名号等特殊符号</p>
                <p class="input-error">请填写作品名称</p>
            </div>
        </div>
    </div>
</script>
<script type="text/template" id="catSelectTpl">
    <div class="write-form-li" id="catFormLi">
        <label class="write-form-label">作品类型</label>
        <div class="write-form-cell">
            <div class="write-input">
                <div class="_twocolumn">
                    <div class="ui-input" >
                        <select id="catSelect" name="category">
                            <option value=""></option>
                            <% _.each(data, function (item) { %>
                                <option 
                                    value="<%= item.categoryid %>"
                                    <% if(selectedID == item.categoryid){ %>
                                    selected
                                    <% } %>
                                ><%= item.categoryname %></option>
                            <% }); %>
                        </select>
                    </div>
                    <div class="ui-input">
                        <select id="subcatSelect" name="subcategory">
                            <option></option>
                        </select>
                    </div>
                </div>
                <p class="input-caution"></p>
                <p class="input-error">请选择作品类型</p>
            </div>
        </div>
    </div>
</script>
<script type="text/template" id="shortStoryCatSelectTpl">
    <div class="write-form-li shortstory-cat" id="catFormLi">
        <label class="write-form-label">作品类型</label>
        <div class="write-form-cell">
            <div class="write-input">
                <div class="">
                    <div class="ui-input dn" >
                        <select id="catSelect" name="category" class="form-ignore">
                            <% _.each(data, function (item) { %>
                                <option value="<%= item.categoryid %>"><%= item.categoryname %></option>
                            <% }); %>
                        </select>
                    </div>
                    <div class="ui-input">
                        <select id="subcatSelect" name="subcategory">
                            <option value=""></option>
                            <% _.each(data[0].subcategoryList, function (item) { %>
                                <option value="<%= item.subcategoryid %>"><%= item.subcategoryname %></option>
                            <% }); %>
                        </select>
                    </div>
                </div>
                <p class="input-caution"><%= data[0].categorydesc %></p>
                <p class="input-error">请选择作品类型</p>
            </div>
        </div>
    </div>
</script>
<script type="text/template" id="actarticleSelectTpl">
    <div class="g-hr mt24 mb24"></div>
    <div class="write-form-li dn" id="actarticleFormLi">
        <label class="write-form-label">征文活动</label>
        <div class="write-form-cell">
            <div class="write-input bc-act">
            </div>
        </div>
    </div>
</script>
<script type="text/template" id="actarticleEmptyOptionTpl">
    <div class="write-input lrc-item">
        <input type="radio" id="act0" name="actarticle" value="0">
        <label for="act0" class="ui-radio"></label>
        <label class="radio-txt mr24" for="act0">不参加活动</label>
    </div>
</script>
<script type="text/template" id="actarticleOptionTpl">
    <% _.each(data, function (item) { %>
    <div class="write-input lrc-item">
        <input type="radio" id="act<%= item.iActArticle.idx %>" name="actarticle" value="<%= item.iActArticle.idx %>">
        <label for="act<%= item.iActArticle.idx %>" class="ui-radio"></label>
        <label class="radio-txt mr24" for="act<%= item.iActArticle.idx %>">
            <%= item.iActArticle.authorcontent %>
            <a class="bc-act-link" href="/portal/dashboard/actarticleDetail?id=<%= item.iActArticle.idx %>" target="_blank">活动详情</a>
        </label>
    </div>
    <% }); %>
</script>
<script type="text/template" id="actExtSelectTpl">
    <div class="write-form-li dn" id="actextFormLi">
        <label class="write-form-label">选择赛区</label>
        <div class="write-form-cell">
            <div class="write-input">
                <p class="input-error">请选择赛区</p>
            </div>
        </div>
    </div>
    <!-- <div class="g-hr mt24 mb24"></div> -->
</script>
<script type="text/template" id="actExtOptionTpl">
    <% _.each(data, function (item) { %>
    <label class="lrc-item">
        <input type="radio" id="artext<%= item.idx %>" name="artext" class="form-ignore" value="<%= item.idx %>">
        <label for="artext<%= item.idx %>" class="ui-radio"></label><label class="radio-txt mr24" for="artext<%= item.idx %>"><%= item.extname %></label>
        <div class="rc-con">
            <p class="input-caution"><%= item.extdescription %></p>
        </div>
    </label>
    <% }); %>
</script>
<script type="text/template" id="precollectionSelectTpl">
    <div class="write-form-li dn" id="precollectionFormLi">
        <label class="write-form-label">预收藏</label>
        <div class="write-form-cell">
            <div class="write-input lrc-item ">
                <% if(data){ %>
                <input type="radio" id="preYes" name="precollection" value="1" checked>
                <label for="preYes" class="ui-radio"></label><label class="radio-txt " for="preYes">是</label>
                <i class="icon-idb jsThemeTips mr24" title="按照单章订阅价格付费阅读作品章节内容"><em class="icon-font icon_info input-vertified">&#xe91d;</em></i> 
                <input type="radio" id="preNo" name="precollection" value="0">
                <label for="preNo" class="ui-radio"></label><label class="radio-txt " for="preNo">否</label>
                <% } %>
                <% if(!data){ %>
                <input type="radio" id="preYes" name="precollection" value="1" disabled>
                <label for="preYes" class="ui-radio"></label><label class="radio-txt " for="preYes">是</label>
                <i class="icon-idb jsThemeTips mr24" title="按照单章订阅价格付费阅读作品章节内容"><em class="icon-font icon_info input-vertified">&#xe91d;</em></i> 
                <input type="radio" id="preNo" name="precollection" value="0" checked>
                <label for="preNo" class="ui-radio"></label><label class="radio-txt " for="preNo">否</label>
                <% } %>
            </div>
            <p class="pre-collect-note _info">创建预收藏作品需要消耗预收藏作品券，你可以在积分兑换页面中消耗 666 积分进行兑换<i class="icon-idb jsThemeTips mr24" title="预收藏作品创建成功后会生成默认章节，正文章节（含默认章节）内容满1000字后会变为正常作品，预收藏标识消失。"><em class="icon-font icon_info input-vertified">&#xe91d;</em></i></p>
        </div>
    </div>
</script>
<script type="text/template" id="saletypeTpl">
    <div class="write-form-li" id="saletypeFormLi">
        <label class="write-form-label">销售意向</label>
        <div class="write-form-cell">
            <div class="write-input lrc-item _info">
                <input type="radio" id="saleSingle" name="saletype" value="1">
                <label for="saleSingle" class="ui-radio"></label><label class="radio-txt " for="saleSingle">单订</label>
                <i class="icon-idb jsThemeTips mr24" title="按照单章订阅价格付费阅读作品章节内容"><em class="icon-font icon_info input-vertified">&#xe91d;</em></i>
                <input type="radio" id="saleMonth" name="saletype" value="2">
                <label for="saleMonth" class="ui-radio"></label><label class="radio-txt " for="saleMonth">包月</label>
                <i class="icon-idb jsThemeTips mr24" title="付X元/月看所有包月作品"><em class="icon-font icon_info input-vertified">&#xe91d;</em></i>
                <p class="input-error">请选择销售意向</p>
            </div>
        </div>
    </div>
</script>
<script type="text/template" id="introInputTpl">
    <div class="write-form-li" id="introFormLi">
        <label class="write-form-label">作品介绍</label>
        <div class="write-form-cell">
            <!-- 添加warning，会出现释放焦点检验有误的样式 -->
            <div class="write-input">
            
                <div class="ui-textarea j-check">
                
                    <textarea rows="8" placeholder="请填写" name="intro"></textarea>
                    <em class="icon-font input-vertified icon_check_circle">&#xe90b;</em>
                </div>
                <p class="input-caution">20~500个字</p>
                <p class="input-error">请填写20~500个字</p>
            </div>
        </div>
    </div>
</script>
<!-- 选择编辑分组 -->
<script id="editorGroupTpl" type="text/html">
    <div class="bc-editor-con j-select">
        <ul class="bc-ec-ul cf">
            <% _.each(data, function (item) { %>
            <li class="bc-ec-li" data-id="<%= item.novelgroup %>">
                <a href="javascript:" class="bc-ec-item">
                    <h4 class="bc-ec-title"><%= item.novelgroupname %></h4>
                    <p class="bc-ec-txt"><%= item.intro %></p>
                    <i class="editor-icon-checked"></i>
                    <p class="editor-more-info js-editor-more">详情<em class="icon-font">&#xe90d;</em></p>
                </a>
            </li>
            <% }); %>
        </ul>
    </div>
</script>
<script type="text/template" id="pagemessTpl">
    <div class="write-form-li" id="editorGroupFormLi">
        <label class="write-form-label">编辑组</label>
        <div class="write-form-cell">
            <div class="write-input">
                <p class="bc-check-group jEmptyEditor">
                    <a class="bc-cg-operate jEvokeEditorModal" href="javascript:" data-event-id="ZQ_E05">请选择编辑组</a>
                </p>
                <p class="bc-check-group jSelectedEditor dn">
                    <span class="bc-cg-txt mr24"></span>
                    <a class="bc-cg-operate jEvokeEditorModal" href="javascript:" data-event-id="ZQ_E08">更换</a>
                </p>
                <input class="dn" name="editorGroup" />
                <p class="input-caution">作品选择对应的编辑组以后将无法修改，请谨慎选择</p>
                <p class="input-error">请选择编辑组</p>
            </div>
        </div>
    </div>
    <div class="write-form-li" id="pagemessFormLi">
        <label class="write-form-label">给读者的话</label>
        <div class="write-form-cell">
            <div class="write-input">
                <div class="ui-textarea j-check">
                    <textarea rows="4" placeholder="在阅文旗下产品阅读我的正版授权作品，感谢您的支持！" name="pagemess"></textarea>
                    <em class="icon-font input-vertified icon_check_circle">&#xe90b;</em>
                </div>
                <p class="input-caution">0～32字，给读者的话将展示在您作品的版权页</p>
                <p class="input-error"></p>
            </div>
        </div>
    </div>
</script>
<script type="text/template" id="formFooter">
    <div class="write-form-li write-form-button">
        <label class="write-form-label"></label>
        <button class="ui-button ui-large ui-button-primary jSubmit" type="button">创建作品</button>
        <button class="ui-button ui-large jPrev" type="button">返回上一步</button>
    </div>
</script>

<script>
var isshortstory = false;
var pageid = isshortstory ? 'ZQ_short_book_create_new' : 'ZQ_book_create_new';
</script>
<script>
    (function(pro){
        function mytrim() {
            return this.replace(/(^\s*)|(\s*$)/g, "");
        }
        if (!pro.trim) {
            pro.trim = mytrim;
        }
    })(String.prototype);
</script>
<script>
    
    var root = "";
    
    var infoUrl = "/ccauthorweb/novel/getInfoWhenNewNovel";
    var bookTitleCheckUrl = "/ccauthorweb/novel/booktitlecheck";
    var actarticleInfoListUrl = "/ccauthorweb/novel/getarticlelist";
    var createBookUrl = "/ccauthorweb/novel/createnovel";
    var editorGroupUrl = "/ccauthorweb/novel/getnovelgrouplist";
    function ajax(option, successCb, failCb) {
        option.dataType = 'json';
        option.contentType = "application/json";
        option.success = function(res) {
            if (res.returnCode === 2000) {
            if (successCb) {
                successCb(res);
                return;
            }
            return;
            }
            if (failCb) {
            failCb({message: res.returnMsg});
            }
        }
        option.error = function(err) {
            if (failCb) {
            failCb({message: "网络错误请重试"});
            }
        }
        if (option.data && option.method === "POST") {
            option.data = JSON.stringify(option.data)
        }
        $.ajax(option);
    }
    function getInfoAjax(data, successCb, failCb) {
        data.t = Date.now();
        ajax({
          url: root + infoUrl,
          data: data,
          method: 'GET'
        }, successCb, failCb);
    }
    function getactarticleInfoListAjax(data, successCb, failCb) {
        ajax({
          url: root + actarticleInfoListUrl,
          data: data,
          method: 'POST'
        }, successCb, failCb);
    }
    function createBookAjax(data, successCb, failCb) {
        ajax({
          url: root + createBookUrl,
          data: data,
          method: 'POST'
        }, successCb, failCb);
    }
    function getEditorGroupAjax(site, categoryid, successCb, failCb) {
        ajax({
          url: root + editorGroupUrl + "?site=" + site + "&categoryid=" + categoryid + "&t=" + Date.now(),
          method: 'GET'
        }, successCb, failCb);
    }
</script>
<script>
    jQuery.validator.addMethod("bookTitleCheck", function(value, element) {
        return this.optional(element) || /^[A-Za-z0-9\u4E00-\u9fa5]{1,15}$/.test(value);
    }, "作品名15字以内，不能有特殊字符");
    jQuery.validator.addMethod("byteRangeLengthByOne", function(value, element, param) {
        value = value.replace(/\r\n/ig, "");
        value = value.replace(/\s+/g, '');
        var length = value.length;
        return this.optional(element) || (length >= param[0] && length <= param[1]);
    }, "请确保输入的值在20-500个字节之间(一个中文字算1个字节)");
</script>
<script>
(function(){
    

    $(document).ready(function(){
        dataReport({
            pageid: pageid,
            eventid: 'ZQ_E01',
            cauthorid: yconfig.ttd
        });
    });

    var step = 1;
    var insubmitting = false;
    var isPresetAct = $("#presetAct").length > 0;

    $("input[name=sex]").on("change", function(){
        var _eid = this.value == 1 ? 'ZQ_E02' : 'ZQ_E03';
        dataReport({
            pageid: pageid,
            eventid: _eid,
            cauthorid: yconfig.ttd
        });
        $("#step1Form .ui-button-primary").removeClass("disabled");
    });
    
    function nextStep() {
        step++;
        $(".wc-progress")
            .removeClass()
            .addClass("wc-progress")
            .addClass("_step" + step);
        $(".wc-step").addClass("dn");
        $("#step" + step + "Form").removeClass("dn");
    }
    function prevStep() {
        if (step <= 1) {
            return;
        }
        step--;
        $(".wc-progress")
            .removeClass()
            .addClass("wc-progress")
            .addClass("_step" + step);
        $(".wc-step").addClass("dn");
        $("#step" + step + "Form").removeClass("dn");
    }

    function getSelectedFreetype() {
        var selected = $("input[name=sex]:checked");
        if (selected.length <= 0) {
            return undefined;
        }
        return selected.val();
    }

    function getSelectedValue(name) {
        var selected = $("input[name=" + name + "]:checked");
        if (selected.length <= 0) {
            return undefined;
        }
        return selected.val();
    }

    function renderSiteSelection(sites) {
        var t = _.template($("#siteSelectTpl").html());
        var _html = t({data: sites});
        return _html;
    }

    function renderCatSelection(categories, selectedID) {
        var t = _.template($("#catSelectTpl").html());
        var _html = t({data: categories, selectedID: selectedID});
        return _html;
    }

    function renderShortStoryCatSelection(categories) {
        var t = _.template($("#shortStoryCatSelectTpl").html());
        var _html = t({data: categories});
        return _html;
    }

    function renderActarticle(actarticles) {
        var t = _.template($("#actarticleSelectTpl").html());
        return t({data: actarticles});
    }

    function renderPrecollection(canCreatePrecollection) {
        var t = _.template($("#precollectionSelectTpl").html());
        return t({data: canCreatePrecollection});
    }

    function refreshForm(info, freetype) {
        var formHtml = "<form>";
        formHtml += renderSiteSelection(info.siteVOS);
        formHtml += $("#nameInputTpl").html();
        if (isshortstory) {
            formHtml += renderShortStoryCatSelection(info.categoryVos);
        } else {
            formHtml += renderCatSelection(info.categoryVos);
        }

        if (isPresetAct) {
            formHtml += $("#presetAct").html();
        } else {
            formHtml += $("#actarticleSelectTpl").html();
            formHtml += $("#actExtSelectTpl").html();
        }
        
        formHtml += renderPrecollection(info.canCreatePrecollection);
        formHtml += $("#saletypeTpl").html();
        formHtml += $("#introInputTpl").html();
        formHtml += $("#pagemessTpl").html();
        formHtml += $("#formFooter").html();
        formHtml += "</form>";
        $("#step2Form").html(formHtml);
       
        $("#saletypeFormLi").addClass("dn");
        $("#saletypeFormLi input").addClass("form-ignore");

        $("#step2Form textarea[name=pagemess]").attr("placeholder", info.randomPageMess);
        
        $("select").each(function() {
            new Select($(this));
        });
        new Tips($('.jsThemeTips'), {
            align: 'reverse',
            theme: 'white'
        });
        bindPrev();
        catChange();
        subcatChange();
        siteChange();
        validateForm();
        pagemessFocus();
        bindPrecollectionChange();
    }

    function validateFreetype(cb) {
        var freetype = getSelectedFreetype();
        var result = true;
        if (freetype === undefined) {
            if (cb) {
                new Dialog().alert('<h6>请选择目标读者</h6>', {
                    buttons: [{ value: "我知道了" }]
                });
                cb(true, {freetype: freetype});
            }
            return;
        }
    
        var reqData = {
            freetype: freetype,
            isshortstory: isshortstory
        };
        if (isPresetAct) {
            reqData.actarticleidx = $("#presetAct").attr("data-actidx");
        }
        getInfoAjax(reqData, function(res) {
            window._allInfo = res.result;
            refreshForm(res.result, freetype);
            if (cb) {
                cb(false, {});
            }
        }, function() {
            window.$.lightTip.error("获取信息失败");
        });
    }

    function submit(cb) {
        var beh = undefined;
        switch(step) {
            case 1:
                beh = validateFreetype;
                break;
            case 2:
                beh = validateForm;
                break;
            default:
                beh = undefined;
        }
        if (beh) {
            beh(cb);
        }
    }

    $(".jNext").on("click", function() {
        dataReport({
            pageid: pageid,
            eventid: 'ZQ_E04',
            cauthorid: yconfig.ttd
        });
        var $this = $(this);
        if ($this.hasClass("disabled")) {
            return;
        }
        submit(function(err, data) {
            if (err) {
                return;
            }
            nextStep();
        });
    });

    function bindPrev() {
        $(".jPrev").on("click", function() {
            dataReport({
                pageid: pageid,
                eventid: 'ZQ_E07',
                cauthorid: yconfig.ttd
            });
            var $this = $(this);
            if ($this.hasClass("disabled")) {
                return;
            }
            prevStep();
        });
    }

    function getCategoryInfo(key) {
        var categoryVos = _allInfo.categoryVos;
        var cat;
        for (var i = 0; i < categoryVos.length; i++) {
            if (categoryVos[i].categoryid == key) {
                return categoryVos[i]
            }
        }
        return;
    }

    function catChange() {
        $("#catSelect").change(function() {
            var value = $("#catSelect option:checked").val();

            if (value){
                unhighlight($("#catSelect"));
                $("#catSelect").siblings().removeClass("error");
            }

            var cat = getCategoryInfo(value);
            var options = cat.subcategoryList;
            var optionHtml = "";
            for(var i = 0; i < options.length; i++) {
                var option = options[i];
                optionHtml += "<option value='" + option.subcategoryid + "'>" + option.subcategoryname + "</option>";
            }
            $("#subcatSelect").html(optionHtml);
            $("#subcatSelect").refresh();

            unhighlight($("#subcatSelect"));
            $("#subcatSelect").siblings().removeClass("error");

            $("#catFormLi .input-caution").text(cat.categorydesc);

            if (!isPresetAct) {
                getactarticleInfoList();
            }
            refreshEditorGroup();
        });
    }

    function subcatChange() {
        $("#subcatSelect").on("change", function() {
            unhighlight($("#subcatSelect"));
            $("#subcatSelect").siblings().removeClass("error");

            if (!isPresetAct) {
                getactarticleInfoList();
            }
        });
    }

    function pagemessFocus() {
        $("textarea[name=pagemess]").on("focus", function() {
            if (!this.value || !this.value.trim()) {
                $(this).val(_allInfo.randomPageMess);
            }
        });
    }

    function bindPrecollectionChange() {
        $("input[name=precollection]").change(function() {
            introValidChange();
        });
    }

    function showPrecollection() {
        if (!$("#precollectionFormLi").hasClass("dn")) {
            return;
        }
        $("#precollectionFormLi").removeClass("dn");
    }

    function hidePrecollection() {
        if ($("#precollectionFormLi").hasClass("dn")) {
            return;
        }
        $("#precollectionFormLi").addClass("dn");
    }

    function introValidChange() {
        var preShow = !$("#precollectionFormLi").hasClass("dn");
        var preValue = getSelectedValue("precollection");

        var rule1 = {
            required: true,
            byteRangeLengthByOne: [20, 500],
            messages: {
                required: "请填写作品介绍",
                byteRangeLengthByOne: "请输入20-500字介绍您的作品"
            }
        };

        var rule2 = {
            required: true,
            byteRangeLengthByOne: [20, 1000],
            messages: {
                required: "请填写作品介绍",
                byteRangeLengthByOne: "请输入20-1000字介绍您的作品"
            }
        };

        
        if (preShow && preValue == 1) {
            $("#introFormLi .input-caution").text("20~1000字");
            $("textarea[name=intro]").rules("remove");
            $("textarea[name=intro]").rules("add", rule2);
        } else {
            $("#introFormLi .input-caution").text("20~500字");
            $("textarea[name=intro]").rules("remove");
            $("textarea[name=intro]").rules("add", rule1);
        }
    }

    function showHidePrecollection(site) {
        var precollectionSite = _allInfo.precollectionSite;
        var show = false;
        for (var i = 0; i < precollectionSite.length; i++) {
            if (precollectionSite[i] == site) {
                show = true;
                break;
            }
        }
        show ? showPrecollection() : hidePrecollection();
    }

    function showHideSaleType(site) {
        var show = site == 2 || site == 22 || site == 23;
        if (show) {
            $("#saletypeFormLi").removeClass("dn");
            $("#saletypeFormLi input").removeClass("form-ignore");
        } else {
            $("#saletypeFormLi").addClass("dn");
            $("#saletypeFormLi input").addClass("form-ignore");
        }
    }

    function chooseEditorGroup(id) {
        var editorInfo;
        
        for (var i = 0; i < _allInfo.editorGroupInfoList.length; i++) {
            if (_allInfo.editorGroupInfoList[i].novelgroup == id) {
                editorInfo = _allInfo.editorGroupInfoList[i];
                break;
            }
        }
        
        if (!editorInfo) {
            return;
        }
        $("#editorGroupFormLi .jEmptyEditor").addClass("dn");
        $("#editorGroupFormLi .jSelectedEditor").removeClass("dn");
        $("#editorGroupFormLi .jSelectedEditor span").text(editorInfo.novelgroupname);
        $("input[name=editorGroup]").val(id);
    }

    function refreshEditorGroup() {
        var site = getSelectedValue("site");
        var categoryid = $("#catSelect").val();

        if (!site || !categoryid) {
            return;
        }

        $("#editorGroupFormLi .jEmptyEditor").addClass("dn");
        $("#editorGroupFormLi .jSelectedEditor").addClass("dn");
        $("input[name=editorGroup]").val("");

        _allInfo.editorGroupInfoList = [];
        getEditorGroupAjax(site, categoryid, function(res) {
            if (!res.result) {
                _allInfo.editorGroupInfoList = [];
                $("#editorGroupFormLi .jSelectedEditor").addClass("dn");
                $("#editorGroupFormLi .jEmptyEditor").removeClass("dn");
                return;
            }

            var editorGroupInfoList = _allInfo.editorGroupInfoList = res.result.novelGroupVOS;
            var lastNovelGroup = _allInfo.lastNovelGroup = res.result.lastNovelGroup;
            var lastNovelGroupInfo;
            
            for (var i = 0; i < _allInfo.editorGroupInfoList.length; i++) {
                if (editorGroupInfoList[i].novelgroup == lastNovelGroup) {
                    lastNovelGroupInfo = editorGroupInfoList[i];
                    break;
                }
            }

            if (lastNovelGroupInfo) {
                chooseEditorGroup(lastNovelGroupInfo.novelgroup);
                unhighlight($("input[name=editorGroup]"));
                return;
            }

            if (_allInfo.editorGroupInfoList.length === 1) {
                chooseEditorGroup(_allInfo.editorGroupInfoList[0].novelgroup);
                unhighlight($("input[name=editorGroup]"));
                return;
            }

            $("#editorGroupFormLi .jSelectedEditor").addClass("dn");
            $("#editorGroupFormLi .jEmptyEditor").removeClass("dn");
        }, function() {
            _allInfo.editorGroupInfoList = [];
        });
    }

    function evokeEditorModal() {
        dataReport({
            pageid: pageid,
            eventid: $(this).attr("data-event-id"),
            cauthorid: yconfig.ttd
        });
        var site = getSelectedValue("site");
        var categoryid = $("select[name=category]").val();
        if (!site || !categoryid) {
            $.lightTip.error("请先填写发布平台及作品分类");
            return;
        }
        if (!_allInfo.editorGroupInfoList || !_allInfo.editorGroupInfoList.length) {
            $.lightTip.error("信息错误，请联系客服");
            return;
        }

        var _html = _.template($("#editorGroupTpl").html())({data: _allInfo.editorGroupInfoList});
        var button1 = {
            value: '确定',
            events: function(e) {
                var editorId = $(".editor-select-body li.current").attr("data-id");

                chooseEditorGroup(editorId);
                unhighlight($("input[name=editorGroup]"));
                e.data.dialog.remove();
            }
        };
        var button2 = {
            value: '跳过，随机分配',
            type: 'secondary',
            events: function(e) {
                dataReport({
                    pageid: 'ZQ_editor_group_select',
                    eventid: 'ZQ_E01',
                    cauthorid: yconfig.ttd
                });
                var randomIndex = Math.floor(Math.random() * _allInfo.editorGroupInfoList.length);
                var randomG = _allInfo.editorGroupInfoList[randomIndex];
                chooseEditorGroup(randomG.novelgroup);
                unhighlight($("input[name=editorGroup]"));
                e.data.dialog.remove();
            }
        }
        var buttons = [];
        if (_allInfo.editorGroupInfoList.length > 1) {
            buttons = [button1, button2];
        } else {
            buttons = [button1];
        }
        var tagDialog = new Dialog({
            title: '当前可选的编辑组有',
            content: _html,
            // >=6个宽度为816，=<7个宽度为504
            width: _allInfo.editorGroupInfoList.length > 6 ? 816 : 504,
            buttons: buttons,
            onShow: function(){
                var self = this;
                var selectedEditorId = $("input[name=editorGroup]").val();
                var selectedLi = $(".bc-ec-li[data-id=" + selectedEditorId + "]");

                this.el.button0.addClass("disabled");
                if (selectedLi.length === 1) {
                    selectedLi.addClass("current");
                    self.el.button0.removeClass("disabled");
                }

                $(".bc-ec-li").each(function() {
                    var txtBlock = $(this).find(".bc-ec-txt");
                    if (txtBlock[0].scrollHeight > txtBlock.height()) {
                        $(this).find(".editor-more-info").attr("style", "");
                    } else {
                        $(this).find(".editor-more-info").attr("style", "display:none");
                    }
                });
               
                $('.j-select').on('click', 'li', function () {
                    $(this).addClass('current').siblings().removeClass('current');
                    self.el.button0.removeClass("disabled");
                });
            }
        })
        tagDialog.el.dialog.addClass("editor-select-body");

        // 点击展示编辑分组详情--js-editor-more
        $(".js-editor-more").on("click", function(e) {
            e.stopPropagation();
            var title = $(this).parent().find(".bc-ec-title").html();
            var content = $(this).parent().find(".bc-ec-txt").html();
            var diaEditorMore =  new Dialog({
                title: title,
                width: 504,
                content: content,
                buttons: [{
                    value: '我知道了'
                }]
            })
            diaEditorMore.el.body.css('white-space','pre-line');
        });

    }
    

    $("#step2Form").delegate('.jEvokeEditorModal', 'click', evokeEditorModal);

    function getactarticleInfoList() {
        var data = {};
        data.site = getSelectedValue("site");
        data.categoryid = $("#catSelect").val();
        data.subcategoryid = $("#subcatSelect").val();
        data.limittype = 1;

        if (!data.site || !data.categoryid || !data.subcategoryid) {
            $("#actarticleFormLi").addClass("dn");
            $("#actextFormLi").addClass("dn");
            $("#actextFormLi input").addClass("form-ignore");
            return;
        }

        getactarticleInfoListAjax(data, function(res) {
            _allInfo.actarticleInfoList = res.result;
            if (!_allInfo.actarticleInfoList || _allInfo.actarticleInfoList.length === 0) {
                $("#actarticleFormLi").addClass("dn");
                $("#actextFormLi").addClass("dn");
                $("#actextFormLi input").addClass("form-ignore");
                return;
            }

            var t = _.template($("#actarticleOptionTpl").html());
            var data = _allInfo.actarticleInfoList;
            
            var _html = $("#actarticleEmptyOptionTpl").html();
            _html += t({data: data});
            $("#actarticleFormLi .write-input").html(_html);
            $("#actarticleFormLi #act0").attr("checked", "");

            actChange();
            $("#actarticleFormLi").removeClass("dn");
            $("#actextFormLi").addClass("dn");
            $("#actextFormLi input").addClass("form-ignore");

        });
    }

    function actChange() {
        $("input[name=actarticle]").change(function() {
            if (!_allInfo.actarticleInfoList || _allInfo.actarticleInfoList.length === 0) {
                $("#actarticleFormLi").addClass("dn");
                $("#actarticleFormLi input").addClass("form-ignore");
                return;
            }
            
            var actarticleInfo;
            for (var i = 0; i < _allInfo.actarticleInfoList.length; i++) {
                var _info = _allInfo.actarticleInfoList[i];
                if (_info.iActArticle.idx == this.value) {
                    actarticleInfo = _allInfo.actarticleInfoList[i];
                    break;
                }
            }
            renderActext(actarticleInfo);
        });
    }

    function renderActext(actarticleInfo) {
        if (!actarticleInfo || !actarticleInfo.iActArticleExt || actarticleInfo.iActArticleExt.length === 0) {
            $("#actextFormLi").addClass("dn");
            $("#actextFormLi input").addClass("form-ignore");
            return;
        }

        var t = _.template($("#actExtOptionTpl").html());
        var _html = t({data: actarticleInfo.iActArticleExt});
        _html += "<p class='input-error'>请选择赛区</p>";
        $("#actextFormLi .write-input").html(_html);
        $("#actextFormLi").removeClass("dn");
        if (actarticleInfo.iActArticleExt && actarticleInfo.iActArticleExt.length > 0) {
            $("#actextFormLi input").removeClass("form-ignore");
        }
    }

    function siteCatChange(site) {
        var catList = [];
        for (var i = 0; i <_allInfo.categoryVos.length; i++) {
            var _cat = _allInfo.categoryVos[i];
            if ((site == 2 || site == 3) && _cat.categoryid == 30078) {
                continue;
            }
            catList.push(_cat);
        }
        var _html = "<option></option>";
        for (var i = 0; i < catList.length; i++) {
            var _cat = catList[i];
            _html += "\n<option value=\"" + _cat.categoryid + "\"";
            if (_cat.categoryid === $("select[name=category]").val()) {
                _html += " selected";
            }
            _html += ">" + _cat.categoryname + "</option>";
        }
        $("#catSelect").html(_html);
        $("#catSelect").refresh();
        
        if (!$("select[name=category]").val()) {
            $("#subcatSelect").html("<option></option>");
            $("#subcatSelect").refresh();
        }
    }

    function siteChange() {
        $("input[name=site]").change(function() {
            showHidePrecollection(this.value);
            showHideSaleType(this.value);
            siteCatChange(this.value);
            introValidChange();

            if (this.value == 22) {
                $("#pagemessFormLi").addClass("dn");
                $("#pagemessFormLi textarea").addClass("form-ignore");
            } else {
                $("#pagemessFormLi").removeClass("dn");
                $("#pagemessFormLi textarea").removeClass("form-ignore");
            }

            if (!isPresetAct) {
                getactarticleInfoList();
            }
            refreshEditorGroup();
        });
    }

    function addError(error, element) {
        element.parents(".write-input").addClass("_error");
        element.parents(".j-check").removeClass("_check");
        element.parents(".write-form-li").find(".input-error").text(error.text());
    }

    function unhighlight(element) {
        element.removeClass("error");
        element.parents(".write-input").removeClass("_error");
        element.parents(".j-check").addClass("_check");
    }

    function handleSubmit(form) {
        dataReport({
            pageid: pageid,
            eventid: 'ZQ_E06',
            cauthorid: yconfig.ttd
        });
        if (insubmitting) {
            return;
        }
        var data = {};
        data.freetype = getSelectedFreetype();
        data.site = getSelectedValue("site");;
        data.title = $("input[name=title]").val();
        data.categoryid = $("select[name=category]").val();
        data.subcategoryid = $("select[name=subcategory]").val();
        data.intro = $("textarea[name=intro]").val();
        data.novelgroup = $("input[name=editorGroup]").val();

        if (!$("#precollectionFormLi").hasClass("dn")) {
            data.isprecollection = getSelectedValue("precollection");
        }

        if (!$("#saletypeFormLi").hasClass("dn")) {
            data.saletype = getSelectedValue("saletype");
        }

        if (!$("#actarticleFormLi").hasClass("dn")) {
            var selectedArtidx = getSelectedValue("actarticle");
            if (selectedArtidx && selectedArtidx != 0) {
                data.artidx = selectedArtidx;
            }
        }

        if ($("#actextFormLi").length > 0 && !$("#actextFormLi").hasClass("dn")) {
            var selectedArtextidx = getSelectedValue("artext");
            if (selectedArtextidx && selectedArtextidx != 0) {
                data.artextidx = selectedArtextidx;
            }
        }

        if (!$("#pagemessFormLi").hasClass("dn")) {
            data.pagemess = $("textarea[name=pagemess]").val();
        }

        insubmitting = true;
        $(".jSubmit").addClass("loading");
        $(".jPrev").addClass("disabled");
        createBookAjax(data, function(res) {
            insubmitting = false;
            $(".jSubmit").removeClass("loading");
            $(".jPrev").removeClass("disabled");
            $("#step3Form a").attr("href", "/portal/booknovels/chaptertmp/CBID/" + res.result.cbid);
            nextStep();
        }, function(err) {
            insubmitting = false;
            $(".jSubmit").removeClass("loading");
            $(".jPrev").removeClass("disabled");
            $.lightTip.error(err.message);
        });
    }

    function validateForm() {
        $("#step2Form form").validate({
            ignore:".form-ignore",
            rules: {
                site: {
                    required: true
                },
                title: {
                    required: true,
                    bookTitleCheck: true,
                    remote: {
                        url: root + bookTitleCheckUrl,
                        dataType: 'json',
                        headers: {
                            'Cache-Control': 'no-cache',
                            'Pragma': 'no-cache'
                        },
                        data: {
                            title: function() {
                                return $( "input[name=title]" ).val();
                            }
                        },
                        dataFilter: function(resString) {
                            if (resString.indexOf('false') > -1 || resString.indexOf('2000') < 0) {
                                return 'false';
                            }
                            return 'true';
                        }
                    }
                },
                category: {
                    required: true
                },
                subcategory: {
                    required: true
                },
                intro: {
                    required: true,
                    byteRangeLengthByOne: [20, 500]
                },
                editorGroup: {
                    required: true
                },
                pagemess: {
                    byteRangeLengthByOne: [0, 32]
                },
                saletype: {
                    required: true
                },
                artext: {
                    required: true
                }
            },
            messages: {
                site: {
                    required: "请选择发布平台"
                },
                title: {
                    required: "请输入作品名",
                    bookTitleCheck: "15字以内，请勿添加书名号等特殊符号",
                    remote: "这本大作已经有人写过了，再想个名字吧！"
                },
                category: {
                    required: "请选择作品类别"
                },
                subcategory: {
                    required: "请选择作品类别"
                },
                intro: {
                    required: "请填写作品介绍",
                    byteRangeLengthByOne: "请输入20-500字介绍您的作品"
                },
                editorGroup: {
                    required: "请选择编辑组"
                },
                pagemess: {
                    byteRangeLengthByOne: "请输入32个字以内的内容"
                },
                saletype: {
                    required: "请选择销售意向"
                },
                artext: {
                    required: "请选择赛区"
                }
            },
            errorPlacement: function(error, element) {
                addError(error, element);
            },
            unhighlight: function(element) {
                var $element = $(element);
                unhighlight($element);
            }
        });
        $("#step2Form form .ui-button-primary").on("click", function() {
            if ($("#step2Form form").valid()) {
                handleSubmit();
            }
            return false;
        });
    }

    

})();
</script>

    <script>
      window.yconfig = {
        isLogin: true,
        ttd: '17752236906517001'
      }
    </script>
    <script type="text/javascript">
      var _mtac = {
        "performanceMonitor": 1
      };
      (function () {
        var mta = document.createElement("script");
        mta.src = "//pingjs.qq.com/h5/stats.js?v2.0.4";
        mta.setAttribute("name", "MTAH5");
        mta.setAttribute("sid", "500659219");
        mta.setAttribute("cid", "500664628");
        var s = document.getElementsByTagName("script")[0];
        s
          .parentNode
          .insertBefore(mta, s);
      })();
    </script>
    
  
<div class="ui-tips-x ui-tips-reverse ui-tips-white" data-align="7-5" style="position: absolute; left: 581px; top: 692px; z-index: 100; display: none;"><span class="ui-tips-before">预收藏作品创建成功后会生成默认章节，正文章节（含默认章节）内容满1000字后会变为正常作品，预收藏标识消失。</span><i class="ui-tips-after"></i></div></body></html>